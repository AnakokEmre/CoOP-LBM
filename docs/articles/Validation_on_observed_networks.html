<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CoOPLBM">
<title>Validation on observed networks • CoOPLBM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Validation on observed networks">
<meta property="og:description" content="CoOPLBM">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CoOPLBM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Available_options.html">Available options</a>
    <a class="dropdown-item" href="../articles/Example_on_other_settings.html">Robustness to model misspecification</a>
    <a class="dropdown-item" href="../articles/Validation_on_observed_networks.html">Validation on observed networks</a>
    <a class="dropdown-item" href="../articles/example.html">Example</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Validation on observed networks</h1>
            <h3 data-toc-skip class="subtitle">Difficulty on assessing
the algorithm when the complete network is unknown</h3>
            
      
      
      <div class="d-none name"><code>Validation_on_observed_networks.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: usethis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://expasy.org/tools/pROC/" class="external-link">pROC</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Type 'citation("pROC")' for a citation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pROC'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cov, smooth, var</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jchiquet/aricode" class="external-link">aricode</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grosssbm.github.io/sbm/" class="external-link">sbm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CoOPLBM</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: robber</span></span>
<span><span class="co">#&gt; Estimation of the Robustness of Bipartite Ecological Networks!</span></span></code></pre></div>
<p>The purpose of this simulation study is to highlight an issue about a
common validation process when trying to find missing interactions. A
common way to validate if an algorithm is able to find missing
interactions is to subsample the interactions matrix, and then try to
find the interactions that have been removed. However, this approach
assumes that the observed interaction matrix already represents the
complete set of interactions. It is possible that the algorithm finds
interactions that were already missing in the observed matrix. This
would penalized the AUC score because these discoveries would be counted
as false positive.</p>
<div class="section level2">
<h2 id="result">Result<a class="anchor" aria-label="anchor" href="#result"></a>
</h2>
<p>We remind in the below graphic that <span class="math inline">\(M\)</span> represents the full interaction matrix
and is a bipartite stochastic bloc model, <span class="math inline">\(N\)</span> is the sampling process follows a
Poisson distribution <span class="math inline">\(\mathcal{P}(\lambda_i\mu_j G)\)</span>, and that
we observe <span class="math inline">\(R_{obs} = M \odot N\)</span> the
element wise product of <span class="math inline">\(M\)</span> and <span class="math inline">\(N\)</span>. We note <span class="math inline">\(V\)</span> the observed support of <span class="math inline">\(R_{obs}\)</span> such as <span class="math inline">\(V_{i,j} = 1\{R_{obs_{i,j}}&gt;0\}\)</span> .
Common validation procedure requires to subsample the observed matrix,
which gives us a matrix <span class="math inline">\(U_{obs}\)</span> and
then trying to find the missing interaction of the observed matrix. <img src="subsampling_schema.png"></p>
<ol style="list-style-type: decimal">
<li>As we can see, on simulated data the CoOP-LBM can retrieve the
missing interaction of M using the observed matrix compared to the LBM
and the DCSBM.</li>
<li>However, if we do the validation as done usually, by subsampling the
observed matrix and trying to find the new missing interactions, we
observe that CoOP-LBM has a lower AUC score than the other methods.</li>
<li>The CoOP-LBM would perform better if we made the comparison directly
with the full <span class="math inline">\(M\)</span> matrix. This matrix
is available when doing simulation, but not in ecological applications,
unless the network is very well sampled.</li>
</ol>
<hr>
<p>In this study there are two kinds of missing interactions :</p>
<ol style="list-style-type: decimal">
<li>Interactions in <span class="math inline">\(M\)</span> which are not
observed in <span class="math inline">\(R_{obs}\)</span>. We remind that
<span class="math inline">\(U_{obs}\)</span> is a subsampling of <span class="math inline">\(R_obs\)</span>, and therefore, this interaction is
also missing in <span class="math inline">\(U_{obs}\)</span>,(<span class="math inline">\(M_{i,j} = 1 , R_{obs\, i,j}=0, U_{obs\,
i,j}=0\)</span>).</li>
<li>Interactions in <span class="math inline">\(M\)</span> which are
observed in <span class="math inline">\(R_{obs}\)</span>, but are not
observed in the subsampling (<span class="math inline">\(M_{i,j} = 1 ,
R_{obs\, i,j}&gt;0, U_{obs\, i,j}=0\)</span>).</li>
</ol>
<p>We fit each method (LBM, CoOP-LBM and DCSBM), and estimate a
probability of missing value <span class="math inline">\(\hat{p}_{i,j}\)</span> where <span class="math inline">\(U_{obs}=0\)</span>. We order these probabilities
in decreasing in order, which would be the order of discoveries, and
then we consider the following values :</p>
<ol style="list-style-type: decimal">
<li>TP M : number of detected values where <span class="math inline">\(M_{i,j}=1\)</span> even tho <span class="math inline">\(R_{obs} = 0 = U_{obs\, i,j}\)</span>
</li>
<li>TP V : number of detected values where <span class="math inline">\(V_{i,j}=1\)</span>.</li>
<li>False positives : number of detected values even if <span class="math inline">\(M_{i,j}=0\)</span>
</li>
</ol>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>As we can see on the figure above, CoOP-LBM detects more missing
interactions coming from the observation process <span class="math inline">\(R_{obs}= M \odot N\)</span> (lign in red) than the
one comming from the subsampling <span class="math inline">\(U_{obs}\)</span></p>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>This graphic is the same as the precedent, but each curve have been
scaled with the maximum value they reach. Once again, we can see that
the LBM and DCSBM will first recover the interactions of <span class="math inline">\(V_{i,j}\)</span> that has gone missing because of
the subsampling <span class="math inline">\(U_{obs}\)</span>, but they
don’t find the missing interactions from <span class="math inline">\(M\)</span> that has gone missing because of <span class="math inline">\(R_{obs}\)</span>.</p>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-17-1.png" width="864">
This figure shows why the LBM and DCSBM has better score when we try to
calculate the AUC with <span class="math inline">\(V_{i,j}\)</span>
instead of <span class="math inline">\(M_{i,j}\)</span>. For the LBM and
the DCSBM, The majority of first discovered interactions are the one
that went missing because of the subsampling of <span class="math inline">\(R_{obs}\)</span> (area in blue). Meanwhile, the
CoOP-LBM detects first the interaction comming from <span class="math inline">\(M\)</span> (area in green). We reach the same
conclusion using the graph below.</p>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-18-1.png" width="960"></p>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-19-1.png" width="480"></p>
<p>If we reunite all the postive values (<span class="math inline">\(TP
V + TP M\)</span>), then CoOP-LBM performs better than LBM and DCSBM.
However in many cases, we only have access to <span class="math inline">\(TP V\)</span>, which in our case, disadvantages
the CoOP-LBM.</p>
<p>All the code needed to replicate these results are available
below.</p>
</div>
<div class="section level2">
<h2 id="code">Code<a class="anchor" aria-label="anchor" href="#code"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n1</span> <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="va">n2</span> <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="va">Q1</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">Q2</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">Q</span><span class="op">=</span><span class="va">Q1</span></span>
<span><span class="va">P</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,</span>
<span>                 <span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,</span>
<span>                 <span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span><span class="op">)</span>,<span class="va">Q1</span>,<span class="va">Q2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alpha1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">alpha2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">simulation1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/robber/man/simulate_lbm.html" class="external-link">simulate_lbm</a></span><span class="op">(</span><span class="va">P</span>,<span class="va">alpha1</span>,<span class="va">alpha2</span>,<span class="va">n1</span>,<span class="va">n2</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">=</span> <span class="va">simulation1</span><span class="op">$</span><span class="va">A</span></span>
<span><span class="va">Z1</span> <span class="op">=</span><span class="va">simulation1</span><span class="op">$</span><span class="va">Z</span></span>
<span><span class="va">Z2</span> <span class="op">=</span><span class="va">simulation1</span><span class="op">$</span><span class="va">W</span></span>
<span><span class="va">G</span><span class="op">=</span> <span class="fl">50</span></span>
<span><span class="va">C1</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n1</span>,<span class="fl">0.3</span>,<span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">C2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n2</span>,<span class="fl">0.3</span>,<span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">C1</span> <span class="op">=</span> <span class="va">C1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">C1</span><span class="op">)</span></span>
<span><span class="va">C2</span> <span class="op">=</span> <span class="va">C2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">C2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#C1 = runif(n1,min=0.2,max=0.5)</span></span>
<span><span class="co">#C2 = runif(n1,min=0.2,max=0.5)</span></span>
<span><span class="co">#C1[1]=1</span></span>
<span><span class="co">#C2[1]=1</span></span>
<span></span>
<span></span>
<span><span class="va">N0</span><span class="op">=</span><span class="va">C1</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">C2</span><span class="op">)</span><span class="op">*</span><span class="va">G</span></span>
<span><span class="va">N</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n1</span><span class="op">*</span><span class="va">n2</span>,<span class="va">N0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">n1</span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">=</span> <span class="va">M</span><span class="op">*</span><span class="va">N</span></span>
<span></span>
<span><span class="va">obsrow</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span></span>
<span><span class="va">obscol</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span></span>
<span><span class="va">R_obs</span> <span class="op">=</span> <span class="va">R</span><span class="op">[</span><span class="va">obsrow</span>,<span class="va">obscol</span><span class="op">]</span></span>
<span><span class="va">M_obs</span> <span class="op">=</span> <span class="va">M</span><span class="op">[</span><span class="va">obsrow</span>,<span class="va">obscol</span><span class="op">]</span></span>
<span><span class="va">Z1_obs</span> <span class="op">=</span> <span class="va">Z1</span><span class="op">[</span><span class="va">obsrow</span><span class="op">]</span></span>
<span><span class="va">Z2_obs</span> <span class="op">=</span> <span class="va">Z2</span><span class="op">[</span><span class="va">obscol</span><span class="op">]</span></span>
<span><span class="va">V</span> <span class="op">=</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">R_obs</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">try1</span><span class="op">=</span><span class="fu"><a href="../reference/fit_unsupervised_LBM.html">fit_unsupervised_LBM</a></span><span class="op">(</span><span class="va">V</span>,exploOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">FALSE</span>,verbosity<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "LBM : Best model has been fitted with 2-2 groups."</span></span>
<span><span class="va">try2</span><span class="op">=</span><span class="fu"><a href="../reference/fit_unsupervised_CoOP_LBM.html">fit_unsupervised_CoOP_LBM</a></span><span class="op">(</span><span class="va">R_obs</span>,exploOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">F</span>,verbosity<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CoOP-LBM : Best model has been fitted with 1-2 groups."</span></span>
<span></span>
<span></span>
<span><span class="va">cov_row</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">X</span><span class="op">[</span><span class="va">k</span>,<span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">X</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">cov_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">X</span><span class="op">[</span>,<span class="va">k</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">X</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">try3</span> <span class="op">=</span> <span class="fu"><a href="https://grosssbm.github.io/sbm/reference/estimateBipartiteSBM.html" class="external-link">estimateBipartiteSBM</a></span><span class="op">(</span><span class="va">R_obs</span>,model <span class="op">=</span> <span class="st">"poisson"</span>,covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cov_row</span>,<span class="va">cov_col</span><span class="op">)</span>,estimOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">F</span>,verbosity <span class="op">=</span><span class="fl">0</span> , exploreMax <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">=</span> <span class="va">try1</span><span class="op">[[</span><span class="fu"><a href="../reference/best_ICL.html">best_ICL</a></span><span class="op">(</span><span class="va">try1</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">model2</span> <span class="op">=</span> <span class="va">try2</span><span class="op">[[</span><span class="fu"><a href="../reference/best_ICL.html">best_ICL</a></span><span class="op">(</span><span class="va">try2</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">model3</span> <span class="op">=</span> <span class="va">try3</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proba_connect1</span> <span class="op">=</span> <span class="va">model1</span><span class="op">$</span><span class="va">pi</span><span class="op">[</span><span class="va">model1</span><span class="op">$</span><span class="va">cluster1</span>,<span class="va">model1</span><span class="op">$</span><span class="va">cluster2</span><span class="op">]</span></span>
<span><span class="va">proba_connect2</span> <span class="op">=</span> <span class="va">model2</span><span class="op">$</span><span class="va">connectivity_prob</span></span>
<span><span class="va">proba_connect3</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">proba_connect3</span><span class="op">[</span><span class="va">V</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">AUC_LBM</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">M_obs</span><span class="op">[</span><span class="va">V</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect1</span><span class="op">[</span><span class="va">V</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                   direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AUC_CoOP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">M_obs</span><span class="op">[</span><span class="va">V</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect2</span><span class="op">[</span><span class="va">V</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                   direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AUC_DCSBM</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">M_obs</span><span class="op">[</span><span class="va">V</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect3</span><span class="op">[</span><span class="va">V</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                    direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"AUC | LBM  = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_LBM</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">" | CoOP-LBM = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_CoOP</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">" | DCSBM = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_DCSBM</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AUC | LBM  = 0.546 | CoOP-LBM = 0.784 | DCSBM = 0.392"</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">U</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">R_obs</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">R_obs</span><span class="op">)</span>,<span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">U</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">U</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">R_obs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsrow2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span></span>
<span><span class="va">obscol2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span></span>
<span><span class="va">U_obs</span> <span class="op">=</span> <span class="va">U</span><span class="op">[</span><span class="va">obsrow2</span>,<span class="va">obscol2</span><span class="op">]</span></span>
<span><span class="va">cov_row</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">U_obs</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">U_obs</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">U_obs</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">X</span><span class="op">[</span><span class="va">k</span>,<span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">X</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">cov_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">U_obs</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">U_obs</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">U_obs</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">X</span><span class="op">[</span>,<span class="va">k</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">X</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">R_obs2</span> <span class="op">=</span> <span class="va">R_obs</span><span class="op">[</span><span class="va">obsrow2</span>,<span class="va">obscol2</span><span class="op">]</span></span>
<span><span class="va">M_obs2</span> <span class="op">=</span> <span class="va">M_obs</span><span class="op">[</span><span class="va">obsrow2</span>,<span class="va">obscol2</span><span class="op">]</span></span>
<span><span class="va">V_obs2</span> <span class="op">=</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">R_obs2</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">M_obs2</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 448</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">V_obs2</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 250</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">U_obs</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 201</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">try1</span><span class="op">=</span><span class="fu"><a href="../reference/fit_unsupervised_LBM.html">fit_unsupervised_LBM</a></span><span class="op">(</span><span class="va">U_obs</span>,exploOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">FALSE</span>,verbosity<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "LBM : Best model has been fitted with 2-2 groups."</span></span>
<span><span class="va">try2</span><span class="op">=</span><span class="fu"><a href="../reference/fit_unsupervised_CoOP_LBM.html">fit_unsupervised_CoOP_LBM</a></span><span class="op">(</span><span class="va">U_obs</span>,exploOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">F</span>,verbosity<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CoOP-LBM : Best model has been fitted with 1-2 groups."</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">try3</span> <span class="op">=</span> <span class="fu"><a href="https://grosssbm.github.io/sbm/reference/estimateBipartiteSBM.html" class="external-link">estimateBipartiteSBM</a></span><span class="op">(</span><span class="va">U_obs</span>,model <span class="op">=</span> <span class="st">"poisson"</span>,covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cov_row</span>,<span class="va">cov_col</span><span class="op">)</span>,estimOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">F</span>,verbosity <span class="op">=</span><span class="fl">0</span> , exploreMax <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model1</span> <span class="op">=</span> <span class="va">try1</span><span class="op">[[</span><span class="fu"><a href="../reference/best_ICL.html">best_ICL</a></span><span class="op">(</span><span class="va">try1</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">model2</span> <span class="op">=</span> <span class="va">try2</span><span class="op">[[</span><span class="fu"><a href="../reference/best_ICL.html">best_ICL</a></span><span class="op">(</span><span class="va">try2</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">model3</span> <span class="op">=</span> <span class="va">try3</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proba_connect1</span> <span class="op">=</span> <span class="va">model1</span><span class="op">$</span><span class="va">pi</span><span class="op">[</span><span class="va">model1</span><span class="op">$</span><span class="va">cluster1</span>,<span class="va">model1</span><span class="op">$</span><span class="va">cluster2</span><span class="op">]</span></span>
<span><span class="va">proba_connect2</span> <span class="op">=</span> <span class="va">model2</span><span class="op">$</span><span class="va">connectivity_prob</span></span>
<span><span class="va">proba_connect3</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AUC_LBM</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">M_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect1</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                   direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AUC_CoOP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">M_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                   direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AUC_DCSBM</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">M_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect3</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                   direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"AUC | LBM  = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_LBM</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">" | CoOP-LBM = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_CoOP</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">" | DCSBM = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_DCSBM</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AUC | LBM  = 0.567 | CoOP-LBM = 0.739 | DCSBM = 0.437"</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">AUC_LBM</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">V_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect1</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                   direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AUC_CoOP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">V_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                   direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AUC_DCSBM</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">V_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">proba_connect3</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                   direction<span class="op">=</span><span class="st">"&lt;"</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"AUC | LBM  = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_LBM</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">" | CoOP-LBM = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_CoOP</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">" | DCSBM = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AUC_DCSBM</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AUC | LBM  = 0.736 | CoOP-LBM = 0.646 | DCSBM = 0.672"</span></span></code></pre></div>
<hr>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span><span class="op">=</span><span class="va">proba_connect1</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">B</span><span class="op">=</span><span class="va">M_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">C</span><span class="op">=</span><span class="va">V_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">orderA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">A</span>,decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">listB1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">listC1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">listFP1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB1</span>,<span class="va">listB1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listC1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC1</span>,<span class="va">listC1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listFP1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP1</span>,<span class="va">listFP1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB1</span>,<span class="va">listB1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">listC1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC1</span>,<span class="va">listC1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listFP1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP1</span>,<span class="va">listFP1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB1</span>,<span class="va">listB1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listC1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC1</span>,<span class="va">listC1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">listFP1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP1</span>,<span class="va">listFP1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">}</span></span>
<span>  </span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span><span class="op">=</span><span class="va">proba_connect2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">B</span><span class="op">=</span><span class="va">M_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">C</span><span class="op">=</span><span class="va">V_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">orderA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">A</span>,decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">listB2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">listC2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">listFP2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB2</span>,<span class="va">listB2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listC2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC2</span>,<span class="va">listC2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listFP2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP2</span>,<span class="va">listFP2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB2</span>,<span class="va">listB2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">listC2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC2</span>,<span class="va">listC2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listFP2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP2</span>,<span class="va">listFP2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB2</span>,<span class="va">listB2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listC2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC2</span>,<span class="va">listC2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">listFP2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP2</span>,<span class="va">listFP2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">}</span></span>
<span>  </span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span><span class="op">=</span><span class="va">proba_connect3</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">B</span><span class="op">=</span><span class="va">M_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">C</span><span class="op">=</span><span class="va">V_obs2</span><span class="op">[</span><span class="va">U_obs</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">orderA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">A</span>,decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">listB3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">listC3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">listFP3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB3</span>,<span class="va">listB3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listC3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC3</span>,<span class="va">listC3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listFP3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP3</span>,<span class="va">listFP3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB3</span>,<span class="va">listB3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">listC3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC3</span>,<span class="va">listC3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listFP3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP3</span>,<span class="va">listFP3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="va">orderA</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">listB3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listB3</span>,<span class="va">listB3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">listC3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listC3</span>,<span class="va">listC3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">listFP3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP3</span>,<span class="va">listFP3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">}</span></span>
<span>  </span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>In this study there are two kinds of missing interactions :</p>
<ol style="list-style-type: decimal">
<li>Interactions in <span class="math inline">\(M\)</span> which are not
observed in <span class="math inline">\(R_{obs}\)</span>. We remind that
<span class="math inline">\(U_{obs}\)</span> is a subsampling of <span class="math inline">\(R_obs\)</span>, and therefore, this interaction is
also missing in <span class="math inline">\(U_{obs}\)</span>,(<span class="math inline">\(M_{i,j} = 1 , R_{obs\, i,j}=0, U_{obs\,
i,j}=0\)</span>).</li>
<li>Interactions in <span class="math inline">\(M\)</span> which are
observed in <span class="math inline">\(R_{obs}\)</span>, but are not
observed in the subsampling (<span class="math inline">\(M_{i,j} = 1 ,
R_{obs\, i,j}&gt;0, U_{obs\, i,j}=0\)</span>).</li>
</ol>
<p>We fit each method (LBM, CoOP-LBM and DCSBM), and estimate a
probability of missing value <span class="math inline">\(\hat{p}_{i,j}}\)</span> where <span class="math inline">\(U_{obs}=0\)</span>. We order these probabilities
in decreasing in order, which would be the order of discoveries, and
then we consider the following values :</p>
<ol style="list-style-type: decimal">
<li>TP M : number of detected values where <span class="math inline">\(M_{i,j}=1\)</span> even tho <span class="math inline">\(R_{obs} = 0 = U_{obs\, i,j}\)</span>
</li>
<li>TP V : number of detected values where <span class="math inline">\(V_{i,j}=1\)</span>.</li>
<li>False positives : number of detected values even if <span class="math inline">\(M_{i,j}=0\)</span>
</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listFP1</span>,type<span class="op">=</span><span class="st">"l"</span>,main <span class="op">=</span> <span class="st">"LBM"</span>,ylab <span class="op">=</span> <span class="st">"Discoveries"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB1</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listC1</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>,<span class="st">"TP : V"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listFP2</span>,type<span class="op">=</span><span class="st">"l"</span>,main <span class="op">=</span> <span class="st">"CoOP-LBM"</span>,ylab <span class="op">=</span> <span class="st">"Discoveries"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB2</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listC2</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>,<span class="st">"TP : V"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listFP3</span>,type<span class="op">=</span><span class="st">"l"</span>,main <span class="op">=</span> <span class="st">"DCSBM"</span>,ylab <span class="op">=</span> <span class="st">"Discoveries"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB3</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listC3</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>,<span class="st">"TP : V"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
<p>As we can see on the figure above, CoOP-LBM detects more missing
interactions coming from the observation process <span class="math inline">\(R_{obs}= M \odot N\)</span> (lign in red) than the
one comming from the subsampling <span class="math inline">\(U_{obs}\)</span></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span>,main <span class="op">=</span> <span class="st">"LBM : "</span>,ylab<span class="op">=</span> <span class="st">"positive rate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listB1</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listC1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listC1</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>,<span class="st">"TP : V"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span>,main <span class="op">=</span> <span class="st">"CoOP-LBM : "</span>,ylab<span class="op">=</span> <span class="st">"positive rate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listB2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listC2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listC2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>,<span class="st">"TP : V"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span>,main <span class="op">=</span> <span class="st">"DCSBM : "</span>,ylab<span class="op">=</span> <span class="st">"positive rate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB3</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listB3</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listC3</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">listC3</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>,<span class="st">"TP : V"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
<p>This graphic is the same as the precedent, but each curve have been
scaled with the maximum value they reach. Once again, we can see that
the LBM and DCSBM will first recover the interactions of <span class="math inline">\(V_{i,j}\)</span> that has gone missing because of
the subsampling <span class="math inline">\(U_{obs}\)</span>, but they
don’t find the missing interactions from <span class="math inline">\(M\)</span> that has gone missing because of <span class="math inline">\(R_{obs}\)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">value</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="va">listB1</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="va">listC1</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">group</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>, <span class="st">"TP : V"</span><span class="op">)</span>,each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP1</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">time0</span>,<span class="va">value</span>,<span class="va">group</span><span class="op">)</span></span>
<span><span class="va">p1</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time0</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"LBM positive rate "</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span> legend.position <span class="op">=</span> <span class="st">"none"</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Index"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">value</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="va">listB2</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="va">listC2</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">group</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>, <span class="st">"TP : V"</span><span class="op">)</span>,each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">time0</span>,<span class="va">value</span>,<span class="va">group</span><span class="op">)</span></span>
<span><span class="va">p2</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time0</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"CoOP-LBM positive rate "</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span> legend.position <span class="op">=</span> <span class="st">"none"</span> <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Index"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">value</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="va">listB3</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="va">listC3</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">group</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FP"</span>,<span class="st">"TP : M"</span>, <span class="st">"TP : V"</span><span class="op">)</span>,each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listFP3</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">time0</span>,<span class="va">value</span>,<span class="va">group</span><span class="op">)</span></span>
<span><span class="va">p3</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time0</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"DCSBM positive rate "</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span> legend.position <span class="op">=</span> <span class="st">"none"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Index"</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot1_legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time0</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"LBM positive rate "</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Discoveries"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">get_only_legend</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">plot</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="va">plot_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html" class="external-link">ggplot_gtable</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html" class="external-link">ggplot_build</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="va">legend_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">plot_table</span><span class="op">$</span><span class="va">grobs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">name</span><span class="op">)</span> <span class="op">==</span> <span class="st">"guide-box"</span><span class="op">)</span> </span>
<span>  <span class="va">legend</span> <span class="op">&lt;-</span> <span class="va">plot_table</span><span class="op">$</span><span class="va">grobs</span><span class="op">[[</span><span class="va">legend_plot</span><span class="op">]</span><span class="op">]</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">legend</span><span class="op">)</span> </span>
<span><span class="op">}</span> </span>
<span><span class="va">legend0</span> <span class="op">&lt;-</span> <span class="fu">get_only_legend</span><span class="op">(</span><span class="va">plot1_legend</span><span class="op">)</span>  </span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span>,<span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">combined_plot</span>, <span class="va">legend0</span>, nrow <span class="op">=</span> <span class="fl">1</span>, widths<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-34-1.png" width="864">
This figure shows why the LBM and DCSBM has better score when we try to
calculate the AUC with <span class="math inline">\(V_{i,j}\)</span>
instead of <span class="math inline">\(M_{i,j}\)</span>. For the LBM and
the DCSBM, The majority of first discovered interactions are the one
that went missing because of the subsampling of <span class="math inline">\(R_{obs}\)</span> (area in blue). Meanwhile, the
CoOP-LBM detects first the interaction comming from <span class="math inline">\(M\)</span> (area in green). We reach the same
conclusion using the graph below.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listFP1</span>,type<span class="op">=</span><span class="st">"l"</span>,main<span class="op">=</span> <span class="st">"false positive"</span>,ylab <span class="op">=</span> <span class="st">"number of discoveries"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listFP2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listFP3</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LBM"</span>,<span class="st">"CoOP-LBM"</span>,<span class="st">"DCSBM"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listB1</span>,type<span class="op">=</span><span class="st">"l"</span>,main<span class="op">=</span> <span class="st">"true positive for missing M interaction"</span>,ylab <span class="op">=</span> <span class="st">"number of discoveries"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB3</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#legend("topleft",lty=c(1,2,3),legend=c("LBM","CoOP-LBM","DCSBM"))</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listC1</span>,type<span class="op">=</span><span class="st">"l"</span>,main<span class="op">=</span> <span class="st">"true positive for missing V interaction"</span>,ylab <span class="op">=</span> <span class="st">"number of discoveries"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listC2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listC3</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-35-1.png" width="864"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#legend("topleft",lty=c(1,2,3),legend=c("LBM","CoOP-LBM","DCSBM"))</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listB1</span><span class="op">+</span><span class="va">listC1</span>,type<span class="op">=</span><span class="st">"l"</span>,main<span class="op">=</span><span class="st">"true positive (all)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB2</span><span class="op">+</span><span class="va">listC2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">listB3</span><span class="op">+</span><span class="va">listC3</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LBM"</span>,<span class="st">"CoOP-LBM"</span>,<span class="st">"DCSBM"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Validation_on_observed_networks_files/figure-html/unnamed-chunk-36-1.png" width="480"></p>
<p>If we reunite all the postive values (TP V + TP M), then CoOP-LBM
performs better than LBM and DCSBM. However in many cases, we only have
access to TP V, which in our case, disadvantages the CoOP-LBM.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Emre ANAKOK.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
